<html>
<head>
<title>WASD Trainer</title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="icon" href="favicon.ico" type="image/x-icon">
<style>
body {padding:auto;margin:auto;background-color:#0e1717;}
canvas { margin: 0 auto; }

</style>
<script src="//cdn.jsdelivr.net/phaser/2.6.2/phaser.min.js"></script>
<script>
var ship;
var enemies;
var scoreText;
var resetText;
var gameOver = 0;
var score = 0;
var enemyTime = 0;
var shipSpeed = 7;
var enemySpeed = 2;
var spawnRate = 1000;
var lastSpawn = 0;
var up;
var left;
var down;
var right;
var reset;
var space;
var style = { font: "bold 32px Arial", fill: "#fff" };

var game = new Phaser.Game(500, 700, Phaser.AUTO, 'WASD-Trainer', { preload: preload, create: create, update: update });

function preload() {
  game.load.image('ship', 'ship.png');
  game.load.image('enemy', 'enemy.png');
}

function create() {
  enemies = game.add.group();
  ship = game.add.sprite(game.world.centerX, game.height - 50, 'ship');
  ship.anchor.setTo(.5);
  scoreText = game.add.text(0, game.height + 10, "Score: " + score, style);
  scoreText.anchor.setTo(0,1);
  resetText = game.add.text(0, 0, "Press SPACE to Restart", style);
  resetText.kill();
  game.input.keyboard.addKeyCapture([ Phaser.Keyboard.W, Phaser.Keyboard.D, Phaser.Keyboard.A, Phaser.Keyboard.D, Phaser.Keyboard.SPACEBAR ]);
  up = game.input.keyboard.addKey(Phaser.Keyboard.W);
  left = game.input.keyboard.addKey(Phaser.Keyboard.A);
  down = game.input.keyboard.addKey(Phaser.Keyboard.S);
  right = game.input.keyboard.addKey(Phaser.Keyboard.D);
  reset = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);
}

function update() {
  if (!gameOver) {
    if (up.isDown && ship.y > 30) ship.y -= shipSpeed;
    if (down.isDown && ship.y < game.height - 30) ship.y += shipSpeed;
    if (left.isDown && ship.x > 30) ship.x -= shipSpeed;
    if (right.isDown && ship.x < game.width - 30) ship.x += shipSpeed;
    var shipBounds = ship.getBounds();
    enemies.forEach(function(enemy) {
      if (Phaser.Rectangle.intersects(shipBounds, enemy.getBounds())) {
        gameOver = 1;
        resetText.revive();
      } else {
        enemy.y += enemySpeed
        if (enemy.y > game.height + 25) {
          enemy.destroy();
          scoreText.setText("Score: " + ++score);
        }
      }
    });
    enemySpeed += .01;
    if (spawnRate != 100) spawnRate -= 1;
    if (game.time.now > lastSpawn + spawnRate) {
      lastSpawn = game.time.now;
      enemies.create(game.rnd.integerInRange(game.width - 25, 25), -50, 'enemy').anchor.setTo(.5);
    }
  } else if (reset.isDown) {
    enemies.filter(function(enemy) { return enemy }).callAll('destroy');
    ship.reset(game.world.centerX, game.height - 50);
    score = 0;
    enemyTime = 0;
    shipSpeed = 7;
    enemySpeed = 2;
    spawnRate = 1000;
    lastSpawn = 0;
    gameOver = 0;
    scoreText.setText("Score: " + score);
    resetText.kill();
  }
}
</script>
</head>
<body>
</body>
</html>